<!DOCTYPE html>
<html lang="en" dir="ltr">
	<head>
		<meta charset="utf-8">
		<title></title>
		<script type="text/javascript" src="babylon.custom.js"></script>

		<script type="text/javascript" src="material.js"></script>
		<script type="text/javascript" src="getCam.js"></script>
		<script type="text/javascript" src="makeskybox.js"></script>
		<script type="text/javascript" src="getModel.js"></script>
		<script type="text/javascript" src="getEnemy.js"></script>
		<script type="text/javascript" src="mapControls.js"></script>
		<script type="text/javascript" src="enemyAI.js"></script>

		<link rel="stylesheet" href="fullscreen.css">
	</head>

	<body>
		<canvas id="renderCanvas"></canvas>

		<script>

		var canvas, engine, scene, camera;

			document.addEventListener("DOMContentLoaded",function(){
				//get the canvas
				canvas = document.getElementById('renderCanvas');

				//make babylon engine
				engine = new BABYLON.Engine(canvas, true);

				//make scene
				scene = new BABYLON.Scene(engine);
				scene.onDispose = function () {
						canvas.removeEventListener("pointerdown", onPointerDown);
						canvas.removeEventListener("pointerup", onPointerUp);
						canvas.removeEventListener("pointermove", onPointerMove);
				}

				//var music = new BABYLON.Sound("Music", "wotw.wav", scene, null, { loop: true, autoplay: true });
        //gravity = new BABYLON.Vector3(0, -9.8 ,0);
				gravity = new BABYLON.Vector3(0, 0 ,0);
				physicsEngine = new BABYLON.CannonJSPlugin();
				scene.enablePhysics(gravity,physicsEngine);

				//insert skybox
				var skybox = makeSkybox(scene,"CloudyLightRays");

				//insert ground
				var ground = BABYLON.Mesh.CreateGround("ground", 10000,10000,1, scene);
				ground.rotation.x = Math.PI; // cull out ground

				//inser camera
				camera = getCam(scene);

				//make lighting
				//var light = new BABYLON.HemisphericLight("hLight", new BABYLON.Vector3(0,100,0), scene);
				var light = new BABYLON.DirectionalLight("dir01", new BABYLON.Vector3(-1, -2, -1), scene);
				light.position = new BABYLON.Vector3(300, 300, -200);

				var lightSphere = BABYLON.Mesh.CreateSphere("sphere", 10, 2, scene);
				lightSphere.position = light.position;
				lightSphere.material = new BABYLON.StandardMaterial("light", scene);
				lightSphere.material.emissiveColor = new BABYLON.Color3(1, 1, 0);

				player = getPlayer(scene);
				camera.lockedTarget = player;

				enemy = getEnemy(scene);
				enemy.position = new BABYLON.Vector3(20,3,20);

/*
				setInterval(function(){
					getEnemy(scene);
				},5000);*/

				scene.registerBeforeRender(function () {
					moveEnemy();

					holdPlayer();

				});

				engine.runRenderLoop(function(){
					scene.render();

				});
			});

		</script>

	</body>
</html>
